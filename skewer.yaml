title: Skupper Hello World using Podman
subtitle: Connect services running as Podman containers
workflow: null
overview: |
  This example is a basic multi-service HTTP application deployed
  across a Kubernetes cluster and a bare-metal host or VM running
  Podman containers.

  It contains two services:

  * A backend service that exposes an `/api/hello` endpoint.  It
    returns greetings of the form `Hi, <your-name>.  I am <my-name>
    (<container>)`.

  * A frontend service that sends greetings to the backend and
    fetches new greetings in response.

  With Skupper, you can run the backend as a container on your local
  machine and the frontend in Kubernetes and maintain connectivity
  between the two services without exposing the backend to the public
  internet.

  <!-- <img src="images/entities.svg" width="640"/> -->
prerequisites: |
  * A working installation of Podman ([installation
    guide][install-podman])

  * The `kubectl` command-line tool, version 1.15 or later
    ([installation guide][install-kubectl])

  * Access to a Kubernetes cluster, from [any provider you
    choose][kube-providers]

  [install-podman]: https://podman.io/getting-started/installation
  [install-kubectl]: https://kubernetes.io/docs/tasks/tools/install-kubectl/
  [kube-providers]: https://skupper.io/start/kubernetes.html
sites:
  kubernetes:
    title: Kubernetes
    platform: kubernetes
    namespace: west
    env:
      KUBECONFIG: ~/.kube/config-west
  podman:
    title: Podman
    platform: podman
    namespace: east
    env:
      SKUPPER_PLATFORM: podman
steps:
  - standard: kubernetes/set_up_your_kubernetes_cluster
  - standard: podman/set_up_your_podman_environment
  - title: Deploy the frontend and backend
    preamble: |
      This example runs the frontend in Kubernetes and the backend as
      a local Podman container.

      In Kubernetes, use `kubectl create deployment` to deploy the
      frontend service in namespace `west`.

      In Podman, use `podman run` to start the backend service on your
      local machine.
    commands:
      kubernetes:
        - run: kubectl create deployment frontend --image quay.io/skupper/hello-world-frontend
      podman:
        - run: podman run --name backend --detach --rm -p 9090:8080 quay.io/skupper/hello-world-backend
  - standard: kubernetes/install_skupper_on_your_cluster
  - standard: general/install_the_skupper_command_line_tool
  - standard: general/create_your_sites
    commands:
      kubernetes:
        - run: skupper site create west --enable-link-access
          output: |
            Waiting for status...
            Site "west" is configured. Check the status to see when it is ready
        - run: |
            kubectl wait --for condition=Ready site/west --timeout=60s # Required with preview 1 - to be removed!
          output: |
            site.skupper.io/west condition met
      podman:
        - run: |
            curl https://raw.githubusercontent.com/skupperproject/skupper/refs/heads/v2/cmd/bootstrap/bootstrap.sh | SKUPPER_PLATFORM=podman sh -s -- -p east -f
            #
            # skupper site create east
            # skupper system reload
  - standard: general/link_your_sites
    commands:
      kubernetes:
        - run: skupper link generate > link.yaml
        - run: |
            #
            # skupper token issue ~/secret.token
      podman:
        - run: sed -i 's/v1alpha1/v2alpha1/g' link.yaml
        - run: mv link.yaml /home/jross/.local/share/skupper/namespaces/default/input/resources/link.yaml
        - run: curl https://raw.githubusercontent.com/skupperproject/skupper/refs/heads/v2/cmd/bootstrap/bootstrap.sh | SKUPPER_PLATFORM=podman sh -s -- -f
        - run: |
            #
            # skupper token redeem ~/secret.token
            # skupper system reload
  - standard: hello_world/expose_the_backend
    commands:
      kubernetes:
        - run: skupper listener create backend 8080
      podman:
        - run: |
            # skupper connector create backend --host 127.0.0.1 --port 9090
            # skupper system reload
    postamble: |
      The commands shown above use the name argument, `backend`, to
      also set the default routing key.  You can use the
      `--routing-key` option to specify another value.
  - standard: hello_world/access_the_frontend
  - standard: general/cleaning_up
    commands:
      kubernetes:
        - run: |
            # skupper site delete --all
      podman:
        - run: curl https://raw.githubusercontent.com/skupperproject/skupper/refs/heads/v2/cmd/bootstrap/remove.sh | sh
        - run: podman rm -f backend
        - run: |
            #
            # skupper site delete --all
            # podman rm -f backend
